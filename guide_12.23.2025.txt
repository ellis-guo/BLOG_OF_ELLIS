================================================================================
PROJECT STATUS & CONTEXT FOR NEW CLAUDE SESSIONS
Last Updated: December 24, 2024
================================================================================

IMPORTANT: This file helps new Claude sessions understand the project quickly.
Read this FIRST before helping with any tasks.

================================================================================
PROJECT OVERVIEW
================================================================================

Personal Blog Website
- Tech Stack: Next.js 15 + TypeScript + Prisma + PostgreSQL + Clerk Auth
- Design Style: Academic minimalist (inspired by jzliu.net)
- Languages: Chinese / English / French (i18n routing)
- Color Scheme: Black text + #F35029 orange accent
- Typography: Rubik (body), Libre Baskerville (headings)

Creator: Ellis Guo (郭世越)
Username for admin: "admin"
Development Philosophy: "Build first, refine later" - step by step approach

================================================================================
COMPLETED FEATURES (Phases 1-7)
================================================================================

Phase 1-6: Core Architecture & Pages - DONE

Basic Structure:
- Next.js 15 project with App Router
- Three-layer layout: root to [locale] to (dashboard)
- Clerk authentication integrated
- Prisma + PostgreSQL database
- Middleware for i18n routing with browser language detection

Database Models (schema.prisma):

1. Profile - Personal information
   Fields: bioZh, bioEn, bioFr (Text)
          email, github, linkedin, twitter, wechat (nullable)
          photoUrl (nullable)

2. LifeMoment - Photo gallery
   Fields: imageUrl (required)
          caption, intro (nullable)
          time (DateTime)
          order (Int for sorting)

3. Post - Blog articles (schema exists but functionality NOT implemented)
   Fields: titleZh, titleEn, titleFr
          contentZh, contentEn, contentFr
          slug, type, visibility

Pages Implemented:

- About Page (/[locale]/about) - Server-side rendered
  Features: 3D photo card with Comet effect (framer-motion)
           Three-language bio display
           Contact information with platform labels
           Life Moments slider (Aceternity UI AnimatedTestimonials)
           Admin buttons (only visible to admin users)

- Navbar - Academic minimalist style
  Features: Animated signature logo (郭世越 Ellis Guo)
           Language switcher dropdown
           Clerk UserButton integration
           Responsive design

Components:
- AnimatedSignatureLogo - Handwritten signature with slide-in animation
- LanguageSwitcher - Language selection dropdown
- CometCard - 3D tilt effect for photos
- LifeMomentsSlider - Photo carousel
- Footer - Simple copyright info

================================================================================
PHASE 7: ADMIN FEATURES (JUST COMPLETED)
================================================================================

1. Edit Profile Feature

Route: /[locale]/admin/profile/edit
Access: Admin only (username === "admin")

Functionality:
- Edit three-language bios (bioZh, bioEn, bioFr)
- Edit five contact fields (email, github, linkedin, twitter, wechat)
- Edit profile photo URL (no upload, just paste URL)

Technical Implementation:
- API: /api/profile
  GET: Fetch current profile data
  PUT: Update profile (with admin check)
- Frontend: Client component using useState + useEffect
- UX: Loading state, Form with data, Save, Success message, Auto redirect
- NO localStorage/sessionStorage (not supported in Claude artifacts)

Design Decisions:
- Single page for all fields (not split into multiple pages)
- Direct image URL input (no Cloudinary SDK integration)
- Simple useState for form management (no form library like react-hook-form)
- Photo preview added after user input

================================================================================

2. Edit Moments Feature

Route: /[locale]/admin/moments/edit
Access: Admin only

Functionality:
- Display all Life Moments in card grid
- Add new moments (imageUrl, caption, intro, time)
- Delete moments (with confirmation dialog)
- NOT implemented: Edit existing moments, Drag-to-reorder

Technical Implementation:
- API: /api/moments
  GET: Fetch all moments (ordered by 'order' field)
  POST: Create new moment (auto-calculates order = max + 1)
  DELETE: Remove moment by ID (query param: ?id=xxx)
- Frontend: Client component with card grid + form
- Auto-order calculation: New photos always added at the end

Design Decisions:
- Single language only (no three-language support for Life Moments)
- Direct URL input for photos (no upload feature)
- Single page: existing moments list + add form
- "Add" and "Delete" are enough for now; "Edit" and "Reorder" maybe later

================================================================================

3. UI Improvements

About Page Updates:
- Contact info now shows platform labels: "GitHub: username" instead of just icon + username
- "Manage Moments" button added (admin only, positioned to the right of carousel arrows)

Button Styling:
- All admin buttons follow Edit Profile style:
  px-6 py-3, border-2 border-black
  bg-white, hover:bg-[#F35029]
  Consistent spacing and transitions

================================================================================
CRITICAL TECHNICAL PATTERNS
================================================================================

Frontend vs Backend Data Fetching

About Page (Static Display):
- Server component: export default async function AboutPage()
- Direct database access: await prisma.profile.findFirst()
- No API calls needed
- Fast, SEO-friendly
- Why? Content is static, doesn't need interactivity

Edit Pages (Interactive Forms):
- Client component: "use client" + export default function EditPage()
- API calls: fetch('/api/profile') for GET/PUT
- useState + useEffect pattern
- Why? Forms need user interaction, real-time updates

Key Insight: Next.js full-stack = frontend & backend in same project
- Pages in /app/[locale]/ = frontend
- Routes in /app/api/ = backend
- No CORS needed, same deployment

================================================================================

React Patterns Used

useState for Form Fields:
const [bioZh, setBioZh] = useState("");
Why? Need to track user input and trigger re-renders

useEffect for Data Loading:
useEffect(() => {
  fetch('/api/profile').then(data => setBioZh(data.bioZh));
}, []); // Empty array = run once on mount
Why? Prevent infinite fetch loops (component re-renders trigger fetches)

Controlled Components:
<input value={bioZh} onChange={(e) => setBioZh(e.target.value)} />
Two-way binding: state to input, input to state

================================================================================

Middleware Important Note

File: middleware.ts

CRITICAL: API routes must skip locale handling!

if (pathname.startsWith("/api/")) {
  return NextResponse.next(); // Don't add language prefix to API routes
}

Why? Without this:
- /api/profile gets redirected to /en/api/profile which is 404
- API routes are global, not language-specific

================================================================================
PENDING FEATURES (NOT STARTED)
================================================================================

- Projects page (list + detail + admin CRUD)
- Blog page (list + article detail + admin editor)
- Post model functionality (schema exists but unused)
- Edit existing Life Moments
- Reorder Life Moments (drag-to-reorder)
- Cloudinary SDK integration for direct uploads
- Markdown editor for blog posts
- Search functionality
- Dark mode

================================================================================
DEVELOPMENT GUIDELINES
================================================================================

Ellis's Preferences (MUST FOLLOW)

1. Communication Style:
   - Explain logic and reasoning BEFORE giving code
   - Wait for confirmation before implementing
   - Use life analogies to explain technical concepts
   - Keep responses conversational, not overly technical

2. Coding Approach:
   - "Build first, refine later" - get it working first
   - Simple solutions over complex ones
   - Don't use libraries unless necessary
   - Prefer explicit code over "clever" solutions

3. Commit Messages:
   - Personal, conversational style is OK
   - Can mix English with Chinese
   - Focus on what was done and why

4. Learning Style:
   - Ellis wants to understand "why" not just "how"
   - Ask clarifying questions when requirements are vague
   - Provide options with pros/cons, let Ellis decide
   - Never assume requirements or features

Git Commit Example (Ellis's style):

It has been a long time since I updated this project last time. 
I finished my finals and had a period of relaxing time.

Update in About page:
1. Add profile edit logic;
2. Add life moments edit logic, with a good preview.

I didn't accomplish 'edit' and 'order' function in life moments 
this time. Just 'add' and 'delete' are good enough for now, 
maybe I'll add them later.

================================================================================
COMMON ISSUES & SOLUTIONS
================================================================================

Issue: API Returns 404
Cause: Middleware redirects API routes
Solution: Add API path check in middleware (already fixed)

Issue: Can't use localStorage in artifacts
Cause: Not supported in Claude.ai artifacts environment
Solution: Use React state (useState) only

Issue: Global CSS overriding component styles
Cause: globals.css has too broad selectors like button {}
Solution: Use !important or create component-specific styles

Issue: Infinite useEffect loop
Cause: Missing dependency array or setState inside useEffect
Solution: Always use [] for mount-only effects, or proper dependencies

================================================================================
FILE STRUCTURE QUICK REFERENCE
================================================================================

Key Files:
- middleware.ts - Language routing + API path handling
- src/app/api/profile/route.ts - Profile CRUD API
- src/app/api/moments/route.ts - Moments CRUD API
- src/app/[locale]/(dashboard)/about/page.tsx - About display page
- src/app/[locale]/admin/profile/edit/page.tsx - Profile editor
- src/app/[locale]/admin/moments/edit/page.tsx - Moments manager
- src/components/LifeMomentsSlider.tsx - Photo carousel with admin button
- src/i18n/locales/*.json - Translation files
- prisma/schema.prisma - Database schema

================================================================================
WHEN STARTING A NEW SESSION
================================================================================

1. Read this file completely
2. Check the most recent commits to see what changed
3. Ask Ellis what they want to work on next
4. Explain the approach before writing code
5. Remember: Ellis values understanding over speed

================================================================================
END OF PROJECT STATUS
================================================================================